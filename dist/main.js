(()=>{"use strict";const e=class{constructor(){this.currentOperand=document.querySelector(".record-data-block"),this.prevOperand=document.querySelector(".prev-data-block")}execute(e){this.currentOperand.textContent=e.currentNum,this.prevOperand.textContent=`${e.prevNum} ${e.operation.sign}`}},t=class{execute(e){e.currentNum=0,e.prevNum="",e.operation={sign:""}}},r=class{constructor(e){this.calculator=e}start(){const r=document.querySelector(".record-data-block");isNaN(r.textContent)||(this.calculator.executeCommand(this.calculator.operation)?(new e).execute(this.calculator):(r.textContent="invalid operation",(new t).execute(this.calculator)))}},u=class{constructor(e){this.num=e}execute(){return+this.num}undo(){return+this.num}};class n extends u{execute(e){return+this.num+ +e}undo(e){return+e-+this.num}}class c extends u{execute(e){return+this.num-+e}undo(e){return+e+ +this.num}}class s extends u{execute(e){return+this.num*+e}undo(e){return+e/+this.num}}class a extends u{execute(e){return+this.num/+e}undo(e){return+e*+this.num}}const o=class extends u{execute(e){return e*e}},i=class extends u{execute(e){return e*e*e}},m=class extends u{constructor(e){super(),this.num=e}execute(e){return this.num**e}},d=class extends u{execute(e){return 1==+e?1:e**.5}},l=class extends u{execute(e){return 1==+e?1:e**(1/3)}},x=class extends u{constructor(e){super(),this.num=e}execute(e){return 1==+e||1==+this.num?1:this.num**(1/e)}},h=class extends u{execute(e){return+e<0?"invalid input":1!==e?e*this.execute(e-1):e}},N=class extends u{execute(e){return 1/e}},p=class extends u{execute(e){return 10**e}};class b{constructor(e=""){this.sign=e}static list={add:n,substract:c,mult:s,divide:a,"degree-y":m,"root-y":x,degree2:o,degree3:i,root2:d,root3:l,fact:h,inverse:N,tenDegreeX:p};create(e,t){const r=new(0,b.list[t])(e);return r.sign=this.sign,r}}const g=b,v=class{execute(e){e.currentNum=""}},w=class{execute(e,t){const r=document.querySelector(".record-data-block").textContent;if("."!==e||!r.includes(".")){if(""!==calculator.currentNum&&""!==calculator.prevNum&&void 0===calculator.operation.execute)return t.prevNum="",void(t.currentNum=e);t.currentNum+=e,"."!==e&&(t.currentNum=Number(t.currentNum))}}},y=new class{constructor(){this.currentNum=0,this.prevNum="",this.memory=new class{memNum=0;add(e){return this.memNum+=+e,this.memNum}substr(e){return this.memNum-=+e,this.memNum}recall(){return this.memNum}clear(){this.memNum=0}},this.operation={sign:""},this.history=[]}executeCommand(e){return""===this.currentNum&&(this.currentNum=this.prevNum),e.execute(this.currentNum)!==1/0&&!isNaN(e.execute(this.currentNum))&&(this.prevNum=e.execute(this.currentNum),this.currentNum=e.execute(this.currentNum),this.operation={sign:""},!0)}},C=document.querySelector(".m-btns"),A=document.querySelector(".btns");C.addEventListener("click",(e=>{const t=document.querySelector(".record-data-block"),r=document.querySelector(".mem-data-block");r.textContent="M",e.target.hasAttribute("data-memory-clear")&&(y.memory.clear(),r.textContent=""),e.target.hasAttribute("data-memory-add")&&y.memory.add(t.textContent),e.target.hasAttribute("data-memory-substr")&&y.memory.substr(t.textContent),e.target.hasAttribute("data-memory-recall")&&(t.textContent=y.memory.recall(),(new w).execute(t.textContent,y))})),A.addEventListener("click",(u=>{if(u.target.hasAttribute("data-num")&&((new w).execute(u.target.textContent,y),(new e).execute(y)),u.target.hasAttribute("data-single-oper")&&(y.operation=(new g).create(y.currentNum,u.target.id),new r(y).start()),u.target.hasAttribute("data-pair-oper")){if(Number.isNaN(+document.querySelector(".record-data-block").textContent))return;if(void 0!==y.operation.execute)return y.executeCommand(y.operation),y.operation=new g(u.target.getAttribute("data-value")).create(y.prevNum,u.target.id),(new v).execute(y),void(new e).execute(y);(new class{execute(e){e.prevNum=e.currentNum,e.currentNum=""}}).execute(y),y.operation=new g(u.target.getAttribute("data-value")).create(y.prevNum,u.target.id),(new v).execute(y),(new e).execute(y)}if(u.target.hasAttribute("data-equal")){if(void 0===y.operation.execute)return;new r(y).start()}if(u.target.hasAttribute("data-percent")){const t=document.querySelector(".record-data-block");if(isNaN(t.textContent))return;y.currentNum=y.prevNum*(t.textContent/100),(new e).execute(y)}if(u.target.hasAttribute("data-plus-minus")){const t=document.querySelector(".record-data-block");if(isNaN(t.textContent))return;y.currentNum=-Number(t.textContent),(new e).execute(y)}u.target.hasAttribute("data-clear-all")&&((new t).execute(y),(new e).execute(y)),u.target.hasAttribute("data-clear-entry")&&((new class{execute(e){e.currentNum=0}}).execute(y),(new e).execute(y))}))})();