(()=>{"use strict";const e=class{constructor(e){this.operandsArray=e}execute(){throw new Error("Execute method is not implemented")}undo(){throw new Error("Undo method is not implemented")}};class t extends e{execute(){const[e,t]=this.operandsArray;return+e+ +t}undo(){const[e]=this.operandsArray;return e}}class r extends e{execute(){const[e,t]=this.operandsArray;return+e-+t}undo(){const[e]=this.operandsArray;return e}}class n extends e{execute(){const[e,t]=this.operandsArray;return+e*+t}undo(){const[e]=this.operandsArray;return e}}class s extends e{execute(){const[e,t]=this.operandsArray;return+e/+t}undo(){const[e]=this.operandsArray;return e}}const a=class extends e{execute(){const[,e]=this.operandsArray;return e*e}undo(){const[,e]=this.operandsArray;return e}},c=class extends e{execute(){const[,e]=this.operandsArray;return e*e*e}undo(){const[,e]=this.operandsArray;return e}},o=class extends e{execute(){const[e,t]=this.operandsArray;return e**t}undo(){const[e]=this.operandsArray;return e}},u=class extends e{execute(){const[,e]=this.operandsArray;return 1==+e?1:e**.5}undo(){const[,e]=this.operandsArray;return e}},i=class extends e{execute(){const[,e]=this.operandsArray;return 1==+e?1:e**(1/3)}undo(){const[,e]=this.operandsArray;return e}},d=class extends e{execute(){const[e,t]=this.operandsArray;return e**(1/t)}undo(){const[e]=this.operandsArray;return e}},m=class extends e{count(e){return 1!==e?e*this.count(e-1):e}execute(){const[,e]=this.operandsArray;return console.log(e),+e<0||+e>=1e3?"invalid input":this.count(e)}undo(){const[,e]=this.operandsArray;return e}},l=class extends e{execute(){const[,e]=this.operandsArray;return 1/e}undo(){const[,e]=this.operandsArray;return e}},h=class extends e{execute(){const[,e]=this.operandsArray;return 10**e}undo(){const[,e]=this.operandsArray;return e}};class p{constructor(e=""){this.sign=e}static list={add:t,substract:r,mult:n,divide:s,"degree-y":o,"root-y":d,degree2:a,degree3:c,root2:u,root3:i,fact:m,inverse:l,tenDegreeX:h};create(e,t){const r=new(0,p.list[t])(e);return r.sign=this.sign,r}}const x=p,y=class{constructor(e){this.calc=e}execute(){return this}},N=class extends y{execute(){this.calc.currentNum=0,this.calc.prevNum="",this.calc.operation={sign:"",id:""}}},g=class extends y{execute(){this.calc.currentNum=0}},b=class extends y{constructor(e){super(e),this.currentOperand=document.querySelector(".record-data-block"),this.prevOperand=document.querySelector(".prev-data-block")}execute(){this.currentOperand.textContent=this.calc.currentNum,this.prevOperand.textContent=`${this.calc.prevNum} ${this.calc.operation.sign}`}},A=class extends y{execute(){this.calc.prevNum=this.calc.currentNum,this.calc.currentNum=""}},v=class extends y{execute(){this.calc.currentNum=0}},w=class extends y{execute(e){const t=document.querySelector(".record-data-block").textContent;if("."!==e||!t.includes(".")){if(""!==this.calc.currentNum&&""!==this.calc.prevNum&&""===this.calc.operation.id)return this.calc.prevNum="",void(this.calc.currentNum=e);this.calc.currentNum+=e,this.calc.currentNum=String(this.calc.currentNum).replace(/^00+/g,"0"),this.calc.currentNum=String(this.calc.currentNum).replace(/^0+[1-9]+/g,/[1-9]+/g.exec(String(this.calc.currentNum))||this.calc.currentNum)}}},C=new class{constructor(){this.currentNum=0,this.prevNum="",this.memory=new class{memNum=0;add(e){return this.memNum+=+e,this.memNum}substr(e){return this.memNum-=+e,this.memNum}recall(){return this.memNum}clear(){this.memNum=0}},this.operation={sign:"",id:""},this.history=[]}executeCommand(e){this.history.push(e),""===this.currentNum&&(this.currentNum=this.prevNum);const t=e.execute();return t!==1/0&&!Number.isNaN(+t)&&(this.prevNum=parseFloat(t.toFixed(10)),this.currentNum=parseFloat(t.toFixed(10)),this.operation={sign:"",id:""},!0)}undoCommand(){if(!this.history.length)return this.currentNum=0,void(this.prevNum="");const e=+this.history.pop().undo();this.prevNum=parseFloat(e.toFixed(10)),this.currentNum=parseFloat(e.toFixed(10))}},f=document.querySelector(".m-btns"),L=document.querySelector(".btns");document.querySelector(".theme-btn").addEventListener("click",(()=>{const e=document.body,t=document.querySelectorAll(".btn");e.classList.contains("day-theme-gray")?(e.classList.remove("day-theme-gray"),e.classList.add("night-theme-gray"),t.forEach((e=>{e.classList.contains("day-theme-gray")?(e.classList.remove("day-theme-gray"),e.classList.add("night-theme-gray")):(e.classList.remove("day-theme-orange"),e.classList.add("night-theme-blue"))}))):(e.classList.remove("night-theme-gray"),e.classList.add("day-theme-gray"),t.forEach((e=>{e.classList.contains("night-theme-gray")?(e.classList.remove("night-theme-gray"),e.classList.add("day-theme-gray")):(e.classList.remove("night-theme-blue"),e.classList.add("day-theme-orange"))})))})),f.addEventListener("click",(e=>{const t=document.querySelector(".record-data-block"),r=document.querySelector(".mem-data-block");Number.isNaN(Number(t.textContent))||(r.textContent="M",e.target.hasAttribute("data-memory-clear")&&(C.memory.clear(),r.textContent=""),e.target.hasAttribute("data-memory-add")&&C.memory.add(t.textContent),e.target.hasAttribute("data-memory-substr")&&C.memory.substr(t.textContent),e.target.hasAttribute("data-memory-recall")&&(t.textContent=C.memory.recall(),new w(C).execute(t.textContent)))})),L.addEventListener("click",(e=>{if(e.target.hasAttribute("data-num")&&(new w(C).execute(e.target.textContent),new b(C).execute()),e.target.hasAttribute("data-single-oper")){C.operation.id=e.target.id,C.operation.sign=e.target.getAttribute("data-value"),C.operation=(new x).create([C.prevNum,C.currentNum],C.operation.id);const t=document.querySelector(".record-data-block");if(Number.isNaN(Number(t.textContent)))return;C.executeCommand(C.operation)?new b(C).execute():(t.textContent="invalid operation",new N(C).execute())}if(e.target.hasAttribute("data-pair-oper")){if(Number.isNaN(+document.querySelector(".record-data-block").textContent))return;if(""!==C.operation.id)return C.operation=new x(e.target.getAttribute("data-value")).create([C.prevNum,C.currentNum],C.operation.id),C.executeCommand(C.operation),C.operation.id=e.target.id,C.operation.sign=e.target.getAttribute("data-value"),new v(C).execute(),void new b(C).execute();new A(C).execute(),C.operation.id=e.target.id,C.operation.sign=e.target.getAttribute("data-value"),new v(C).execute(),new b(C).execute()}if(e.target.hasAttribute("data-equal")){if(""===C.operation.id)return;C.operation=(new x).create([C.prevNum,C.currentNum],C.operation.id);const e=document.querySelector(".record-data-block");if(Number.isNaN(Number(e.textContent)))return;C.executeCommand(C.operation)?new b(C).execute():(e.textContent="invalid operation",new N(C).execute())}if(e.target.hasAttribute("data-percent")){const e=document.querySelector(".record-data-block");if(Number.isNaN(+e.textContent))return;C.currentNum=C.prevNum*(e.textContent/100),new b(C).execute()}if(e.target.hasAttribute("data-plus-minus")){const e=document.querySelector(".record-data-block");if(Number.isNaN(+e.textContent))return;C.currentNum=-Number(e.textContent),new b(C).execute()}e.target.hasAttribute("data-clear-all")&&(new N(C).execute(),new b(C).execute()),e.target.hasAttribute("data-clear-entry")&&(new g(C).execute(),new b(C).execute()),e.target.hasAttribute("data-undo")&&(console.log(C),C.undoCommand(),new b(C).execute())}))})();